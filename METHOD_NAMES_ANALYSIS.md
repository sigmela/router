# Анализ названий методов Router

## Публичные методы (Public)

| Текущее название | Что делает | Предложение | Комментарий |
|-----------------|------------|-------------|-------------|
| `subscribe` | Подписывается на изменения роутера | ✅ Оставить | Стандартное название для подписки |
| `getRootStackId` | Возвращает ID корневого стека | ✅ Оставить | Понятно |
| `getGlobalStackId` | Возвращает ID глобального стека | ✅ Оставить | Понятно |
| `subscribeRoot` | Подписывается на изменения root | ✅ Оставить | Понятно |
| `getRootTransition` | Возвращает transition для root | ✅ Оставить | Понятно |
| `setRoot` | Устанавливает новый root | ✅ Оставить | Понятно |
| `debugGetState` | Возвращает состояние для отладки | ✅ Оставить | Debug метод |
| `debugMatchRoute` | Тестирует match маршрута | ✅ Оставить | Debug метод |
| `debugGetStackInfo` | Возвращает информацию о стеке | ✅ Оставить | Debug метод |
| `debugGetAllStacks` | Возвращает все стеки | ✅ Оставить | Debug метод |
| `navigate` | Навигация на путь | ✅ Оставить | Стандартное API |
| `replace` | Заменяет текущий маршрут | ✅ Оставить | Стандартное API |
| `goBack` | Возврат назад | ✅ Оставить | Стандартное API |
| `getVisibleRoute` | Возвращает видимый маршрут | ✅ Оставить | Понятно |
| `getStackHistory` | Возвращает историю стека | ✅ Оставить | Понятно |
| `subscribeStack` | Подписывается на изменения стека | ✅ Оставить | Понятно |

## Приватные методы (Private)

### Управление состоянием

| Текущее название | Что делает | Предложение | Комментарий |
|-----------------|------------|-------------|-------------|
| `setState` | Обновляет состояние роутера | ✅ Оставить | Стандартное название |
| `updateStackHistories` | Обновляет истории всех стеков | ✅ Оставить | Понятно |
| `areArraysEqual` | Сравнивает два массива | ✅ Оставить | Понятно |
| `emit` | Эмитит события для слушателей | ✅ Оставить | Стандартное название |
| `emitRootChange` | Эмитит изменения root | ✅ Оставить | Понятно |

### Навигация

| Текущее название | Что делает | Предложение | Комментарий |
|-----------------|------------|-------------|-------------|
| `performNavigation` | Выполняет навигацию | ✅ Оставить | Понятно |
| `applyHistoryChange` | Применяет изменение истории (push/replace/pop/popTo) | ✅ Оставить | Понятно |
| `recomputeVisibleRoute` | Пересчитывает видимый маршрут | ✅ Оставить | Понятно |
| `syncStateForSameRoute` | Синхронизирует состояние для того же маршрута | ✅ Оставить | ✅ Уже переименовано |
| `popOnce` | Удаляет один элемент из истории | ⚠️ `popFromActiveStack` | Текущее название не отражает, что это для активного стека |
| `parse` | Парсит URL и выполняет навигацию | ⚠️ `parseAndNavigate` или `navigateFromUrl` | Название слишком общее, не отражает что это для URL |

### Поиск и сопоставление маршрутов

| Текущее название | Что делает | Предложение | Комментарий |
|-----------------|------------|-------------|-------------|
| `matchBaseRoute` | Находит подходящий маршрут для pathname+query | ✅ Оставить | Понятно |
| `findExistingRoute` | Ищет существующий маршрут в истории по routeId+pathname+params | ✅ Оставить | Понятно |
| `findExistingRouteByPathname` | Ищет существующий маршрут по pathname+params (без routeId) | ✅ Оставить | Понятно |
| `getTopForTarget` | Возвращает последний элемент стека | ⚠️ `getTopOfStack` | "ForTarget" неясно, лучше "OfStack" |
| `findStackById` | Находит стек по ID | ✅ Оставить | Понятно |
| `matchQueryPattern` | Проверяет соответствие query паттерну | ✅ Оставить | Понятно |

### Работа с TabBar

| Текущее название | Что делает | Предложение | Комментарий |
|-----------------|------------|-------------|-------------|
| `resolveTargetStackAndRoute` | Определяет целевой стек и маршрут для активации | ✅ Оставить | Понятно |
| `findChildStackRouteForPathname` | Ищет дочерний стек (таб) с указанным pathname | ✅ Оставить | Понятно |
| `findRootRouteWithTabBar` | Находит маршрут в root stack с TabBar | ✅ Оставить | Понятно |
| `isRouteInTabBar` | Проверяет, принадлежит ли routeId TabBar | ✅ Оставить | Понятно |
| `activateTabBarForRoute` | Активирует TabBar для указанного routeId | ✅ Оставить | Понятно |
| `findTabBarInStack` | Находит TabBar в указанном стеке | ✅ Оставить | Понятно |
| `activateStack` | Активирует стек через stackActivator | ✅ Оставить | Понятно |

### Seed и инициализация

| Текущее название | Что делает | Предложение | Комментарий |
|-----------------|------------|-------------|-------------|
| `getAutoSeed` | Получает seed для узла (явный или автоматический) | ✅ Оставить | Понятно |
| `seedInitialHistory` | Инициализирует начальную историю | ✅ Оставить | Понятно |
| `addChildNodeSeeds` | Добавляет seed для childNode в массив items | ⚠️ `addChildNodeSeedsToItems` | Более точно отражает, что добавляет в items |
| `seedChildNodes` | Добавляет seed для childNode в историю | ⚠️ `addChildNodeSeedsToHistory` | Более точно отражает, что добавляет в историю |
| `ensureStackHasSeed` | Обеспечивает наличие seed для стека | ✅ Оставить | Понятно |

### Работа с путями

| Текущее название | Что делает | Предложение | Комментарий |
|-----------------|------------|-------------|-------------|
| `parsePath` | Парсит путь на pathname и query | ✅ Оставить | Понятно |
| `normalizeBasePath` | Нормализует базовый путь | ✅ Оставить | Понятно |
| `joinPaths` | Объединяет пути | ✅ Оставить | Понятно |
| `stripBasePath` | Удаляет базовый путь из pathname | ✅ Оставить | Понятно |
| `combinePathWithBase` | Комбинирует путь с базовым | ✅ Оставить | Понятно |
| `computeBasePathSpecificity` | Вычисляет специфичность базового пути | ✅ Оставить | Понятно |

### Работа с историей браузера (Web)

| Текущее название | Что делает | Предложение | Комментарий |
|-----------------|------------|-------------|-------------|
| `isWebEnv` | Проверяет, веб ли окружение | ✅ Оставить | Понятно |
| `getCurrentUrl` | Получает текущий URL | ✅ Оставить | Понятно |
| `readIndex` | Читает индекс из state | ⚠️ `readHistoryIndex` | Более точно отражает, что это индекс истории |
| `getHistoryIndex` | Получает индекс истории | ✅ Оставить | Понятно |
| `ensureHistoryIndex` | Обеспечивает наличие индекса истории | ✅ Оставить | Понятно |
| `getRouterPathFromHistory` | Получает путь роутера из истории | ✅ Оставить | Понятно |
| `getPersistenceForPath` | Проверяет, нужно ли синхронизировать путь с URL | ⚠️ `shouldSyncPathWithUrl` | Более понятное название |
| `pushUrl` | Делает pushState | ✅ Оставить | Понятно |
| `replaceUrl` | Делает replaceState | ✅ Оставить | Понятно |
| `replaceUrlSilently` | Делает replaceState без триггера событий | ✅ Оставить | Понятно |
| `buildUrlFromVisibleRoute` | Строит URL из видимого маршрута | ✅ Оставить | Понятно |
| `patchHistoryOnce` | Патчит историю один раз | ⚠️ `patchBrowserHistoryOnce` | Более точно отражает, что это для браузера |
| `setupBrowserHistory` | Настраивает синхронизацию с историей браузера | ✅ Оставить | Понятно |
| `syncUrlWithStateAfterInternalPop` | Синхронизирует URL после внутреннего pop | ⚠️ `syncUrlAfterPop` | Более короткое и понятное |

### Утилиты

| Текущее название | Что делает | Предложение | Комментарий |
|-----------------|------------|-------------|-------------|
| `log` | Логирует сообщение | ✅ Оставить | Понятно |
| `generateKey` | Генерирует уникальный ключ | ✅ Оставить | Понятно |
| `createHistoryItem` | Создает элемент истории | ✅ Оставить | Понятно |
| `mergeOptions` | Объединяет опции экрана | ✅ Оставить | Понятно |
| `areShallowEqual` | Сравнивает объекты поверхностно | ✅ Оставить | Понятно |
| `buildRegistry` | Строит реестр маршрутов | ✅ Оставить | Понятно |

## Рекомендации по переименованию

### Высокий приоритет (неясные названия)

1. **`popOnce` → `popFromActiveStack`**
   - Причина: Работает с активным стеком (видимым маршрутом). Текущее название не отражает контекст
   - Строка: 2064

2. **`parse` → `buildHistoryFromUrl` или `initializeFromUrl`**
   - Причина: Название слишком общее. Метод не просто парсит, а строит полную историю из URL (deep linking). Это инициализация состояния роутера из URL
   - Строка: 2132

3. **`getTopForTarget` → `getTopOfStack`**
   - Причина: "ForTarget" неясно, лучше "OfStack". Метод просто возвращает последний элемент стека
   - Строка: 1050

### Средний приоритет (можно улучшить)

4. **`addChildNodeSeeds` → `addChildNodeSeedsToItems`**
   - Причина: Более точно отражает, что добавляет в items
   - Строка: 1342

5. **`seedChildNodes` → `addChildNodeSeedsToHistory`**
   - Причина: Более точно отражает, что добавляет в историю
   - Строка: 1430

6. **`getPersistenceForPath` → `shouldSyncPathWithUrl`**
   - Причина: Более понятное название (boolean метод)
   - Строка: 1815

7. **`readIndex` → `readHistoryIndex`**
   - Причина: Более точно отражает, что это индекс истории
   - Строка: 1753

8. **`patchHistoryOnce` → `patchBrowserHistoryOnce`**
   - Причина: Более точно отражает, что это для браузера
   - Строка: 1909

9. **`syncUrlWithStateAfterInternalPop` → `syncUrlAfterInternalPop`**
   - Причина: Более короткое, но сохраняет важную информацию о "internal" (это не браузерный pop, а внутренний)
   - Строка: 2008

## Итоговая статистика

- **Всего методов:** 66
- **Публичных методов:** 16
- **Приватных методов:** 50
- **Методов с хорошими названиями:** 57 (86%)
- **Методов для переименования:** 9 (14%)
  - Высокий приоритет: 3
  - Средний приоритет: 6

## Вывод

Большинство методов имеют понятные названия. Основные проблемы:
1. Несколько методов с общими названиями (`parse`, `popOnce`)
2. Некоторые методы не отражают контекст (`getTopForTarget`, `readIndex`)
3. Методы работы с seed можно сделать более точными
4. Важно различать "видимый" и "активный" стек

**Пересмотренные предложения:**
- `popOnce` → `popFromActiveStack` (работает с активным стеком)
- `parse` → `buildHistoryFromUrl` (строит историю из URL, не просто парсит)
- `syncUrlWithStateAfterInternalPop` → `syncUrlAfterInternalPop` (сохраняет важную информацию о "internal")

Рекомендуется переименовать методы высокого приоритета для улучшения читаемости кода.
